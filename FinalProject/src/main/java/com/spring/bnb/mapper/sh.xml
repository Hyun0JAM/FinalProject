<?xml version="1.0" encoding="UTF-8"?>

<!-- ===== #28. mapper 기본 설정 ===== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<!-- ===== #29. 루트 엘리먼트 및 네임스페이스 설정하기(이 네임스페이스의 이름은 프로젝트 전체 내에서 반드시 고유해야만 한다.) ===== --> 
<mapper namespace="sh">
	
	<select id="getMemberList" resultType="com.spring.bnb.model.MemberVO">
		select userid, username, pwd, email, phone, post, addr, detailAddr, gender
		    , to_char(birthday,'yyyymmdd') as birthday, introduction, memberstatus, profileimg, warncount, regdate
		from member
		order by regdate desc
	</select>
	
	<select id="getSearchMember" parameterType="HashMap" resultType="com.spring.bnb.model.MemberVO">
		select userid, username, pwd, email, phone, post, addr, detailAddr, gender
		    , to_char(birthday,'yyyymmdd') as birthday, introduction, memberstatus, profileimg, warncount, regdate
		from member
		where 1=1
		and ${searchType} like '%'|| #{searchWord} ||'%'
		order by regdate desc
	</select>
	
	<!-- <resultMap type="HashMap" id="memberMap">
		<result javaType="String" column="username" property="username"/>
		<result javaType="String" column="userid" property="userid"/>
		<result javaType="String" column="birthday" property="birthday"/>
		<result javaType="String" column="gender" property="gender"/>
		<result javaType="String" column="email" property="email"/>
		<result javaType="String" column="phone" property="phone"/>
		<result javaType="String" column="addr" property="addr"/>
		<result javaType="String" column="detailAddr" property="detailAddr"/>
		<result javaType="String" column="reservationcode" property="reservationcode"/>
	</resultMap> -->
	
	<select id="getMemberDetail" parameterType="String" resultType="com.spring.bnb.model.MemberVO">
		select userid, username, pwd, email, phone, post, addr, detailAddr, gender
		    , to_char(birthday,'yyyymmdd') as birthday, introduction, memberstatus, profileimg, warncount, regdate
		from member
		where userid = #{userid}
	</select>
	
	<resultMap type="HashMap" id="ReservationMap">
		<result javaType="String" column="rsvcode" property="rsvcode"/>
	</resultMap>
	
	<select id="getReservation" parameterType="String" resultMap="ReservationMap">
		select rsvcode
		from reservation
		where fk_userid = #{userid}
	</select>
	
	<resultMap type="HashMap" id="couponMap">
		<result javaType="String" column="fk_cpcode" property="fk_cpcode"/>
	</resultMap>
	
	<select id="getMycoupon" parameterType="String" resultMap="couponMap">
		select fk_cpcode
		from mycoupon
		where fk_userid = #{userid}
	</select>
	
	
	<resultMap type="HashMap" id="reportMap">
		<result javaType="String" column="report_idx" property="report_idx"/>
		<result javaType="String" column="fk_userid" property="fk_userid"/>
		<result javaType="String" column="reporttype" property="reporttype"/>
		<result javaType="String" column="report_content" property="report_content"/>
		<result javaType="String" column="report_date" property="report_date"/>
		<result javaType="String" column="report_status" property="report_status"/>
		<result javaType="String" column="report_subject" property="report_subject"/>
	</resultMap>
	
	<select id="getReport" resultMap="reportMap">
		select report_idx, fk_userid, reporttype, report_content, report_date, report_status, report_subject
		from report
		order by report_idx desc
	</select>
	
	
	
	
	
	
	
</mapper>